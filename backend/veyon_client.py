private_key = """-----BEGIN PRIVATE KEY-----
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
JSptZ6y1VCC8PgoVnXimcDzo5NihSJU=
-----END PRIVATE KEY-----"""

import requests

class VeyonClient:
    def __init__(self, base_url: str = "http://10.71.0.109"):
        # Initialize the Veyon API client
        self.base_url = base_url
        self.connection_uid = None

    def authenticate(self, auth_method: str, credentials: dict) -> dict:
        # Authenticate with the Veyon Server
        credential = {
            "keyname": "word-master",
            "keydata": private_key
        }
        response = requests.post(
            f"{self.base_url}/api/v1/authentication/localhost",
            json={"method": auth_method, "credentials": credential}
        )
        response.raise_for_status()
        self.connection_uid = response.json()["connection-uid"]
        return response.json()

    def get_screenshot(self) -> bytes:
        # Get current screenshot from remote computer as PNG image
        response = requests.get(
            f"{self.base_url}/api/v1/framebuffer?format=png",
            headers={"Connection-Uid": self.connection_uid}
        )
        response.raise_for_status()
        return response.content

    def lock_screens(self):
        # Lock all screens on remote computers
        response = requests.put(
            f"{self.base_url}/api/v1/feature/ccb535a2-1d24-4cc1-a709-8b47d2b2ac79",
            headers={"Connection-Uid": self.connection_uid},
            json={"active": True}
        )
        response.raise_for_status()
        return True